



  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google" content="notranslate">
  <meta http-equiv="Content-Language" content="en">
  <meta name="robots" content="no-translate">
  <title>CC - English -</title>

  <!-- Quill CSS -->
  <link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">

  <style>
    html, body { translate: none !important; -webkit-user-select: none; user-select: none; -webkit-touch-callout: none; }
    * { translate: none !important; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #f8f9fb;
      margin: 0;
      color: #222;
      font-size: 16px;
      line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, #004080, #0066cc);
      color: #ffffff;
      padding: 25px 20px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }
    header h1 { margin: 0; font-size: 1.9em; letter-spacing: 0.5px; }
    #timer { text-align: right; font-weight: bold; margin-top: 10px; }

    main {
      max-width: 900px;
      margin: 40px auto;
      background: #fff;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
      padding: 40px;
      max-width: 520px;
      margin: 80px auto;
      text-align: left;
    }
    .card h2 { color: #004080; margin-top: 0; text-align: center; }

    label { display:block; margin: 12px 0 8px; font-weight: bold; }
    input[type="text"], input[type="email"], select {
      width: 100%; padding: 10px; border:1px solid #ccc; border-radius:6px;
    }
    textarea { width: 100%; padding: 10px; border:1px solid #ccc; border-radius:6px; }

    select {
      white-space: normal;
      word-wrap: break-word;
      padding: 8px;
    }

    button {
      background:#004080; color:#fff; border:none; padding:12px 28px;
      border-radius:6px; cursor:pointer; font-size:16px;
    }
    button:hover { background:#003666; }
    .btn-row { display:flex; gap:12px; flex-wrap: wrap; margin-top: 16px; }
    .btn-row.center { justify-content: center; }
    .btn-row.right { justify-content: flex-end; }
    .btn-light { background:#e9eef7; color:#004080; }
    .btn-light:hover { background:#dbe6f7; }

    ol { padding-left: 20px; }
    ol li { margin-bottom: 14px; }

    #exam, #confirm, #partA, #partB { display: none; }
    #partA.active, #partB.active { display: block; }

    .editor-card {
      border:1px solid #e3e6ee; border-radius:12px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.06);
    }
    .ql-toolbar.ql-snow { border:none; border-bottom:1px solid #e3e6ee; background:#f9fbff; }
    .ql-container.ql-snow { border:none; min-height: 260px; }
    .ql-editor { min-height: 240px; }
    .muted { color:#666; font-size: 14px; }
  </style>



  <header>
    <h1>CC - English — Risk & Financial Control (M2EFIG1)</h1>
    <div id="timer"></div>
  </header>

  <main>
    <!-- LOGIN -->
    <section id="login" class="card">
      <h2>Start Exam</h2>
      <p>Enter your details to begin. Once started, you will have <b>40 minutes</b>.</p>
      <label>Name:</label><input type="text" id="studentName" required="">
      <label>Email:</label><input type="email" id="studentEmail" required="">
      <label>Class Code:</label><input type="text" id="classCode" required="">
      <div class="btn-row center">
        <button id="startBtn" type="button">Start</button>
      </div>
    </section>

    <!-- CONFIRM -->
    <section id="confirm" class="card">
      <h2>Confirm Your Details</h2>
      <p><b>Name:</b> <span id="confirmName"></span></p>
      <p><b>Email:</b> <span id="confirmEmail"></span></p>
      <p class="muted">Please confirm your details. If anything is wrong, go back and correct it.</p>
      <div class="btn-row">
        <button type="button" class="btn-light" id="confirmBackBtn">← Back</button>
        <button type="button" id="confirmBeginBtn">Begin Exam →</button>
      </div>
    </section>

    <!-- EXAM -->
    <section id="exam">
      <form id="examForm">
        <input type="hidden" name="studentName" id="studentNameField">
        <input type="hidden" name="studentEmail" id="studentEmailField">
        <input type="hidden" name="classCode" id="classCodeField">

        <!-- PART A -->
        <div id="partA" class="active">
          <h2>Part A – Vocabulary Matching</h2>
          <ol>
            <li>Audit
        <select name="q1">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Governance
        <select name="q2">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Risk Mapping
        <select name="q3">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Provisions
        <select name="q4">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Fraud
        <select name="q5">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Liability
        <select name="q6">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Consolidation
        <select name="q7">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Impairment
        <select name="q8">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Stakeholder
        <select name="q9">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
<li>Compliance
        <select name="q10">
          <option value="">-- Choose --</option><option>An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.</option><option>The system of rules, roles, and processes used to direct and control a company</option><option>Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.</option><option>A financial reserve for a potential future expense or loss</option><option>An intentional act of deception for personal or corporate gain</option><option>A legal responsibility to pay for damages or debts</option><option>Combining the financial results of different subsidiaries</option><option>When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss</option><option>Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).</option><option>Adhering to laws, regulations, standards, and internal policies</option>
        </select>
      </li>
          </ol>
          <div class="btn-row right">
            <button type="button" id="toPartB">Next → Part B</button>
          </div>
        </div>

        <!-- PART B -->
        <div id="partB">
          <h2>Part B – Writing Task</h2>
          <p class="muted">“PayGate Ltd — Possible Fraud Risk”

You are a Financial Controller at PayGate Ltd, a European online-payment company.

During a recent internal audit, you noticed that the company’s Asian branch reports very large profits, but the local bank accounts do not show the same cash balance. The local managers say the money is held by a third-party partner, but they refuse to share official documents.

Write an email to your Chief Financial Officer (CFO) or Audit Manager to:

1. Summarize what you discovered,
2. Explain the risks to the company (financial, legal, or reputational),
3. Recommend what action should be taken next

Requirements:

1. Use at least three vocabulary words from Section A

2. Follow a clear professional structure: Subject → Greeting → Body →    Closing.</p>

          <div class="editor-card">
            <div id="editor"></div>
          </div>

          <div class="btn-row">
            <button type="button" class="btn-light" id="toPartA">← Back to Part A</button>
            <button type="submit">Submit Exam</button>
          </div>
        </div>
      </form>
    </section>
  </main>

  <!-- JS at the end (load once) -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>

  <script>
  document.addEventListener("DOMContentLoaded", function() {
    if (window.emailjs) { try { emailjs.init("Bb0oPYBiZGQcyIz5r"); } catch(e){} }

    // Elements
    const login  = document.getElementById("login");
    const confirmSec = document.getElementById("confirm");
    const exam   = document.getElementById("exam");

    const startBtn = document.getElementById("startBtn");
    const confirmBackBtn  = document.getElementById("confirmBackBtn");
    const confirmBeginBtn = document.getElementById("confirmBeginBtn");

    const confirmName  = document.getElementById("confirmName");
    const confirmEmail = document.getElementById("confirmEmail");

    const partA = document.getElementById("partA");
    const partB = document.getElementById("partB");
    const toPartA = document.getElementById("toPartA");
    const toPartB = document.getElementById("toPartB");

    const timerDisplay = document.getElementById("timer");
    const form = document.getElementById("examForm");

    // Guard: if any required node missing, stop and log
    const required = [login, confirmSec, exam, startBtn, confirmBackBtn, confirmBeginBtn, confirmName, confirmEmail, partA, partB, toPartA, toPartB, timerDisplay, form];
    if (required.some(n => !n)) {
      console.error("Missing required DOM nodes. Check IDs.", {login, confirmSec, exam, startBtn, confirmBackBtn, confirmBeginBtn, confirmName, confirmEmail, partA, partB, toPartA, toPartB, timerDisplay, form});
      return;
    }

    // Timer
    let timeLeft = 40 * 60;
    let timer;

    // Correct answers + word list (auto-filled)
    const correctAnswers = {"q1":"An independent examination of a company’s accounts, processes, and controls to give reasonable assurance that the financial statements are free from misstatement.","q2":"The system of rules, roles, and processes used to direct and control a company","q3":"Identifying key risks, estimating likelihood and impact, and visualizing them to prioritize actions.","q4":"A financial reserve for a potential future expense or loss","q5":"An intentional act of deception for personal or corporate gain","q6":"A legal responsibility to pay for damages or debts","q7":"Combining the financial results of different subsidiaries","q8":"When an asset (like equipment or goodwill) loses value, and the company must reduce its value in the financial statements to reflect that loss","q9":"Any party affected by or interested in the company (shareholders, employees, customers, suppliers, lenders, regulators, communities).","q10":"Adhering to laws, regulations, standards, and internal policies"};
    const wordNames = ["Audit","Governance","Risk Mapping","Provisions","Fraud","Liability","Consolidation","Impairment","Stakeholder","Compliance"];

    // Lazy Quill
    let quill = null;
    function ensureQuill() {
      if (!quill) {
        quill = new Quill('#editor', {
          theme: 'snow',
          modules: {
            toolbar: [
              ['bold','italic','underline'],
              [{ list: 'ordered' }, { list: 'bullet' }],
              ['clean']
            ]
          }
        });
      }
    }

    function startTimer() {
      timer = setInterval(() => {
        timeLeft--;
        const m = Math.floor(timeLeft / 60), s = timeLeft % 60;
        timerDisplay.textContent = `Time Remaining: ${m}:${s.toString().padStart(2,"0")}`;
        if (timeLeft <= 0) { clearInterval(timer); submitExam(); }
      }, 1000);
    }

    function enableFullScreen() {
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen().catch(()=>{});
        document.addEventListener("fullscreenchange", () => {
          if (!document.fullscreenElement) {
            alert("Exam terminated. Fullscreen required.");
            location.reload();
          }
        });
      }
    }

    function randomizeSelectsKeepFirst() {
      document.querySelectorAll("#partA select").forEach(sel => {
        const opts = Array.from(sel.options);
        const first = opts.shift(); // remove first
        for (let i = opts.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [opts[i].text, opts[j].text] = [opts[j].text, opts[i].text];
        }
        sel.innerHTML = "";
        sel.appendChild(first);
        opts.forEach(o => sel.appendChild(o));
        sel.selectedIndex = 0;
      });
    }

    // ----- Start → Confirm -----
    startBtn.addEventListener("click", () => {
      const name  = (document.getElementById("studentName").value || "").trim();
      const email = (document.getElementById("studentEmail").value || "").trim();
      const code  = (document.getElementById("classCode").value || "").trim();

      if (!name || !email) { alert("Please fill in your details."); return; }
      if (code !== "M2EFIG1") { alert("Invalid class code."); return; }

      confirmName.textContent  = name;
      confirmEmail.textContent = email;

      // Move to Confirm page
      login.style.display = "none";
      confirmSec.style.display = "block";
    });

    // ----- Confirm page buttons -----
    function beginExam() {
      // Copy confirmed inputs into hidden fields
      const name  = (document.getElementById("studentName").value || "").trim();
      const email = (document.getElementById("studentEmail").value || "").trim();
      const code  = (document.getElementById("classCode").value || "").trim();

      document.getElementById("studentNameField").value  = name;
      document.getElementById("studentEmailField").value = email;
      document.getElementById("classCodeField").value    = code;

      // Show Part A
      confirmSec.style.display = "none";
      exam.style.display  = "block";
      partA.classList.add("active");
      partB.classList.remove("active");

      // Anti-cheat & timer & shuffle
      enableFullScreen();
      startTimer();
      randomizeSelectsKeepFirst();
    }

    confirmBackBtn.addEventListener("click", () => {
      confirmSec.style.display = "none";
      login.style.display = "block";
    });

    confirmBeginBtn.addEventListener("click", () => {
      beginExam();
    });

    // ----- Navigation Part A <-> Part B -----
    toPartB.addEventListener("click", () => {
      partA.classList.remove("active");
      partB.classList.add("active");
      ensureQuill();
    });
    toPartA.addEventListener("click", () => {
      partB.classList.remove("active");
      partA.classList.add("active");
    });

    // ----- Submit -----
    form.addEventListener("submit", e => {
      e.preventDefault();
      submitExam();
    });

    function submitExam() {
      clearInterval(timer);

      const fd = new FormData(form);
      const name  = fd.get("studentName")  || document.getElementById("studentNameField").value;
      const email = fd.get("studentEmail") || document.getElementById("studentEmailField").value;
      const minutesUsed = 40 - Math.floor(timeLeft / 60);

      const emailHtml = quill ? quill.root.innerHTML.trim() : "<em>(No response)</em>";
      const totalQs = document.querySelectorAll('#partA select[name^="q"]').length || 10;

      let scoreA = 0;
      let partARowsHTML = "";
      for (let i = 1; i <= totalQs; i++) {
        const sel  = fd.get("q" + i) || "No answer";
        const corr = correctAnswers["q" + i] || "";
        const ok   = sel === corr;
        if (ok) scoreA++;
        const mark = ok ? "✅ Correct" : `❌ Incorrect → Correct answer: ${corr}`;
        partARowsHTML += `
          <tr>
            <td style="padding:8px;border:1px solid #ccc;">${wordNames[i-1] || ("Q"+i)}</td>
            <td style="padding:8px;border:1px solid #ccc;">${sel}</td>
            <td style="padding:8px;border:1px solid #ccc;color:${ok ? 'green' : '#b00'};">${mark}</td>
          </tr>`;
      }

      const partBScore = "___ / 10";
      const finalNote  = "___ / 20";

      const htmlReport = `
        <h2 style="color:#004080;margin:0 0 8px 0;">Results – CC - English - – ${name} (M2EFIG1)</h2>
        <table style="border-collapse:collapse;width:100%;max-width:640px;font-size:14px;margin:0 0 12px 0;">
          <tr><td style="padding:4px 0;"><b>Student Name:</b> ${name}</td></tr>
          <tr><td style="padding:4px 0;"><b>Student Email:</b> ${email}</td></tr>
          <tr><td style="padding:4px 0;"><b>Class Code:</b> M2EFIG1</td></tr>
          <tr><td style="padding:4px 0;"><b>Time Taken:</b> ${minutesUsed} min</td></tr>
        </table>
        <hr style="border:none;border-top:1px solid #ddd;margin:14px 0;">

        <h3 style="color:#004080;margin:10px 0 8px 0;">Part A – Vocabulary Matching</h3>
        <table style="border-collapse:collapse;width:100%;font-size:15px;margin-top:8px;">
          <thead>
            <tr style="background:#004080;color:#fff;text-align:left;">
              <th style="padding:8px;border:1px solid #ccc;">Word</th>
              <th style="padding:8px;border:1px solid #ccc;">Student Answer</th>
              <th style="padding:8px;border:1px solid #ccc;">Result</th>
            </tr>
          </thead>
          <tbody>
            ${partARowsHTML}
          </tbody>
        </table>
        <p style="margin:10px 0 0 0;"><b>Part A Score:</b> ${scoreA} / ${totalQs}</p>

        <hr style="border:none;border-top:1px solid #ddd;margin:16px 0;">

        <h3 style="color:#004080;margin:10px 0 8px 0;">Part B – Written Exercise</h3>
        <div style="border:1px solid #ccc;border-radius:6px;padding:10px;background:#f9f9f9;">
          ${emailHtml}
        </div>

        <table style="border-collapse:collapse;width:100%;font-size:15px;margin-top:6px;">
          <thead>
            <tr style="background:#004080;color:#fff;text-align:left;">
              <th style="padding:8px;border:1px solid #ccc;">Criterion</th>
              <th style="padding:8px;border:1px solid #ccc;">Maximum</th>
              <th style="padding:8px;border:1px solid #ccc;">Awarded</th>
            </tr>
          </thead>
          <tbody>
            <tr><td style="padding:8px;border:1px solid #ccc;">Vocabulary Use</td><td style="padding:8px;border:1px solid #ccc;">/3</td><td style="padding:8px;border:1px solid #ccc;">___ / 3</td></tr>
            <tr><td style="padding:8px;border:1px solid #ccc;">Structure & Clarity</td><td style="padding:8px;border:1px solid #ccc;">/3</td><td style="padding:8px;border:1px solid #ccc;">___ / 3</td></tr>
            <tr><td style="padding:8px;border:1px solid #ccc;">Language Accuracy & Tone</td><td style="padding:8px;border:1px solid #ccc;">/2</td><td style="padding:8px;border:1px solid #ccc;">___ / 2</td></tr>
            <tr><td style="padding:8px;border:1px solid #ccc;">Professional Style</td><td style="padding:8px;border:1px solid #ccc;">/2</td><td style="padding:8px;border:1px solid #ccc;">___ / 2</td></tr>
          </tbody>
        </table>
   <p style="margin:12px 0 6px 0;"><b>Instructor Comments:</b></p>
      <div style="border:1px solid #ccc;border-radius:6px;padding:10px;background:#fdfdfd;min-height:48px;">
        [Type feedback here]
      </div>
  <p style="margin:10px 0 0 0;"><b>Part B Score:</b> ${partBScore}</p>

      <hr style="border:none;border-top:1px solid #ddd;margin:16px 0;">

      <h4 style="color:#004080;margin:10px 0 8px 0;">Score Summary</h4>
 
      <table style="border-collapse:collapse;width:100%;max-width:460px;font-size:15px;">
        <tr>
          <td style="padding:8px;border:1px solid #ccc;">Part A Score</td>
          <td style="padding:8px;border:1px solid #ccc;">${scoreA} / ${totalQs}</td>
        </tr>
        <tr>
          <td style="padding:8px;border:1px solid #ccc;">Part B Score</td>
          <td style="padding:8px;border:1px solid #ccc;">${partBScore}</td>
        </tr>
        <tr>
          <td style="padding:8px;border:1px solid #ccc;"><b>Final Note</b></td>
          <td style="padding:8px;border:1px solid #ccc;"><b>${finalNote}</b></td>
        </tr>
      </table>

      <div style="border-top:1px solid #ccc;margin-top:16px;padding-top:8px;font-size:12px;color:#555;">
        <em>This report was generated automatically for the English Exam – Business Resources.</em>
      </div>
    `;


      const subject = "(NAME) CC - English - M2 EFI G1".replace("(NAME)", name);

      if (window.emailjs) {
        emailjs.send("service_opm4h6b", "template_r0u784p", {
          from_name: name,
          from_email: email,
          subject,
          message_html: htmlReport
        })
        .then(() => {
          alert("✅ Exam submitted successfully.");
          exam.style.display = "none";
        })
        .catch(err => {
          alert("❌ Error sending exam: " + (err && err.text ? err.text : err));
          console.error("EmailJS Error:", err);
        });
      } else {
        alert("EmailJS not loaded; submission simulated.");
      }
    }
  });
  </script>


